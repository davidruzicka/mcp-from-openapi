{
  "$schema": "../../profile-schema.json",
  "profile_name": "gitlab-oauth",
  "description": "GitLab API with OAuth 2.0 authentication (HTTP transport only)",
  "parameter_aliases": {
    "id": ["project_id", "group_id", "user_id", "resource_id", "merge_request_iid", "issue_iid", "badge_id", "branch", "job_id"]
  },
  "tools": [
    {
      "name": "manage_groups",
      "description": "Work with GitLab groups. Actions: 'list' (all groups), 'get' (group details), 'list_projects' (projects in group), 'list_subgroups' (subgroups of group). Use 'list' to discover groups, 'list_projects' to see projects in a specific group.",
      "operations": {
        "list": "getApiV4Groups",
        "get": "getApiV4GroupsId",
        "list_projects": "getApiV4GroupsIdProjects",
        "list_subgroups": "getApiV4GroupsIdSubgroups"
      },
      "metadata_params": ["action"],
      "parameters": {
        "action": {
          "type": "string",
          "enum": ["list", "get", "list_projects", "list_subgroups"],
          "description": "Action to perform",
          "required": true
        },
        "group_id": {
          "type": "string",
          "description": "Group ID (numeric like '36173' or short name like 'ai-adoption') Required when action is: get, list_projects, list_subgroups.",
          "required_for": ["get", "list_projects", "list_subgroups"]
        },
        "search": {
          "type": "string",
          "description": "Search for groups/projects by name"
        },
        "owned": {
          "type": "boolean",
          "description": "Limit to groups owned by current user (for list action)"
        },
        "archived": {
          "type": "boolean",
          "description": "Limit by archived status (for list_projects action)"
        },
        "page": {
          "type": "integer",
          "description": "Page number for pagination",
          "default": 1
        },
        "per_page": {
          "type": "integer",
          "description": "Items per page (recommended max 100)",
          "default": 20
        }
      }
    },
    {
      "name": "manage_projects",
      "description": "Work with GitLab projects. Actions: 'list' (all projects), 'get' (project details), 'search' (search projects). Use 'list' to discover projects, 'search' to find specific ones.",
      "operations": {
        "list": "getApiV4Projects",
        "get": "getApiV4ProjectsId"
      },
      "metadata_params": ["action"],
      "parameters": {
        "action": {
          "type": "string",
          "enum": ["list", "get"],
          "description": "Action to perform",
          "required": true
        },
        "project_id": {
          "type": "string",
          "description": "Project ID (numeric like '123' or URL-encoded path like 'group%2Fproject') Required when action is: get.",
          "required_for": ["get"]
        },
        "search": {
          "type": "string",
          "description": "Search for projects by name or description"
        },
        "membership": {
          "type": "boolean",
          "description": "Limit to projects current user is a member of"
        },
        "owned": {
          "type": "boolean",
          "description": "Limit to projects owned by current user"
        },
        "page": {
          "type": "integer",
          "description": "Page number for pagination",
          "default": 1
        },
        "per_page": {
          "type": "integer",
          "description": "Items per page (recommended max 100)",
          "default": 20
        }
      }
    }
  ],
  "interceptors": {
    "auth": {
      "type": "oauth",
      "oauth_config": {
        "authorization_endpoint": "${env:GITLAB_OAUTH_AUTHORIZATION_URL}",
        "token_endpoint": "${env:GITLAB_OAUTH_TOKEN_URL}",
        "client_id": "${env:GITLAB_OAUTH_CLIENT_ID}",
        "client_secret": "${env:GITLAB_OAUTH_CLIENT_SECRET}",
        "scopes": ["api", "read_user"],
        "redirect_uri": "http://localhost:3003/oauth/callback"
      }
    },
    "base_url": {
      "value_from_env": "API_BASE_URL",
      "default": "https://gitlab.seznam.net/api/v4"
    },
    "rate_limit": {
      "max_requests_per_minute": 600
    },
    "retry": {
      "max_attempts": 3,
      "backoff_ms": [1000, 2000, 4000],
      "retry_on_status": [429, 502, 503, 504]
    },
    "array_format": "brackets"
  }
}

