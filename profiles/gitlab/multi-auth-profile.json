{
  "$schema": "../../profile-schema.json",
  "profile_name": "gitlab-multi-auth",
  "description": "GitLab API with multi-auth support: OAuth for interactive users, Bearer token for CI/CD",
  "tools": [
    {
      "name": "manage_projects",
      "description": "Work with GitLab projects. Actions: 'list' (all projects), 'get' (project details)",
      "operations": {
        "list": "getApiV4Projects",
        "get": "getApiV4ProjectsId"
      },
      "metadata_params": ["action"],
      "parameters": {
        "action": {
          "type": "string",
          "enum": ["list", "get"],
          "description": "Action to perform",
          "required": true
        },
        "project_id": {
          "type": "string",
          "description": "Project ID (numeric or URL-encoded path)",
          "required": false
        },
        "search": {
          "type": "string",
          "description": "Search for projects by name or description",
          "required": false
        },
        "owned": {
          "type": "boolean",
          "description": "Limit to projects owned by current user",
          "required": false
        }
      }
    },
    {
      "name": "manage_merge_requests",
      "description": "Work with merge requests. Actions: 'list' (all MRs in project), 'get' (single MR details), 'create' (create new MR)",
      "operations": {
        "list": "getApiV4ProjectsIdMergeRequests",
        "get": "getApiV4ProjectsIdMergeRequestsMergeRequestIid",
        "create": "postApiV4ProjectsIdMergeRequests"
      },
      "metadata_params": ["action"],
      "parameters": {
        "action": {
          "type": "string",
          "enum": ["list", "get", "create"],
          "description": "Action to perform",
          "required": true
        },
        "project_id": {
          "type": "string",
          "description": "Project ID (numeric or URL-encoded path)",
          "required": true
        },
        "merge_request_iid": {
          "type": "integer",
          "description": "Internal ID of merge request",
          "required": false
        },
        "state": {
          "type": "string",
          "enum": ["opened", "closed", "merged", "all"],
          "description": "Filter by state",
          "required": false
        },
        "source_branch": {
          "type": "string",
          "description": "Source branch name (for create)",
          "required": false
        },
        "target_branch": {
          "type": "string",
          "description": "Target branch name (for create)",
          "required": false
        },
        "title": {
          "type": "string",
          "description": "MR title (for create)",
          "required": false
        }
      }
    }
  ],
  "interceptors": {
    "auth": [
      {
        "type": "oauth",
        "priority": 0,
        "oauth_config": {
          "authorization_endpoint": "${env:GITLAB_OAUTH_AUTHORIZATION_URL}",
          "token_endpoint": "${env:GITLAB_OAUTH_TOKEN_URL}",
          "client_id": "${env:GITLAB_OAUTH_CLIENT_ID}",
          "client_secret": "${env:GITLAB_OAUTH_CLIENT_SECRET}",
          "scopes": ["api", "read_repository"],
          "redirect_uri": "https://mcp-gitlab.ai.iszn.cz/oauth/authorize"
        }
      },
      {
        "type": "bearer",
        "priority": 1,
        "value_from_env": "CI_API_TOKEN"
      }
    ]
  }
}

